<section class="header">
    <h2>Your Events</h2>
</section>

<div class="card-deck">
    <div class="card" *ngFor="let event of events">
        <div class="card-body">
            <div class="edit-button">
                <button mat-icon-button routerLink="/main/edit" (click)="setCurrentEvent(event)">
                    <mat-icon>edit</mat-icon>
                </button>
            </div>
            <h5 class="card-title">{{event.name}}</h5>
            <div class="card-text">{{event.description}}</div>
        </div>
        <div class="card-header">
            <div class="align-left">
                <h5>Tasks</h5>
            </div>
            <div class="align-right">
                <div class="task-add-container">
                    <button class="task-add-button" id="eventId-{{event.id}}" (click)="openTaskAddForm(event)">
                        <mat-icon class="task-add-icon">add</mat-icon>
                    </button>
                </div>
                <div class="task-form-popup" id="addForm-eventId-{{event.id}}">
                    <div class="task-form-container">
                        <button class="task-close-button" id="taskAddClose" (click)="closeTaskAddForm(event)">
                            <mat-icon class="task-cancel-icon">cancel</mat-icon>
                        </button>
                        <h3>Add a new task</h3>
                        <form [formGroup]="taskAddForm" (ngSubmit)="submitTaskAddForm(event)">
                            <mat-form-field class="title-field" appearance="legacy">
                                <label>
                                    <input
                                        matInput
                                        type="text"
                                        class="control"
                                        placeholder="New Task"
                                        formControlName="title">
                                </label>
                            </mat-form-field>
                            <mat-form-field class="description-field" appearance="legacy">
                                <label>
                                    <input
                                        matInput
                                        type="text"
                                        class="control"
                                        placeholder="This is a description of your new task"
                                        formControlName="description">
                                </label>
                            </mat-form-field>
                            <div class="task-submit-button-container">
                                <button type="submit" class="task-submit-button">
                                    <mat-icon class="task-submit-icon">check_circle</mat-icon>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="list-group list-group-flush" *ngFor="let task of event.tasks">
            <div class="list-group-item tooltip-container list-group-item-action">
                <div class="lgi-text">{{task.title}}</div>
                <div class="tooltip-content">
                    <h6>{{task.title}}</h6>
                    <p>{{task.description}}</p>
                </div>
                <div class="lgi-settings">
                    <button class="task-settings-button" id="taskId-{{task.id}}" (click)="openTaskSettings(task)">
                        <mat-icon class="task-settings-icon">settings</mat-icon>
                    </button>
                    <div class="task-form-popup" id="editForm-taskId-{{task.id}}">
                        <div class="task-form-container">
                            <button class="task-close-button" id="taskEditClose" (click)="closeTaskSettings(task)">
                                <mat-icon class="task-cancel-icon">cancel</mat-icon>
                            </button>
                            <h3>Edit task</h3>
                            <form [formGroup]="taskEditForm" (ngSubmit)="submitTaskEditForm()">
                                <mat-form-field class="title-field" appearance="legacy">
                                    <label>
                                        <input
                                            matInput
                                            type="text"
                                            placeholder="Task title"
                                            value="{{task.title}}">
                                    </label>
                                </mat-form-field>
                                <mat-form-field class="description-field" appearance="legacy">
                                    <label>
                                        <input
                                            matInput
                                            type="text"
                                            placeholder="Task description"
                                            value="{{task.description}}">
                                    </label>
                                </mat-form-field>
                                <div class="task-submit-button-container">
                                    <button type="submit" class="task-submit-button">
                                        <mat-icon class="task-submit-icon">check_circle</mat-icon>
                                    </button>
                                    <button type="button" class="task-delete-button" (click)="removeTask()">
                                        <mat-icon class="task-delete-icon">delete</mat-icon>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-footer">
            <small class="text-muted">{{event.startTime}}</small>
            <small class="text-muted">{{event.endTime}}</small>
        </div>
    </div>
</div>

<div>
    {{ now | date: 'HH:mm:ss'}}
</div>
<div class="eventItem">
    <span>{{user.username}}</span>
    <br>
    <span>{{user.password}}</span>
    <br>
    <span>{{user.email}}</span>
    <br>
    <span>{{user.id}}</span>
</div>

<button
    class="button-bottom-right"
    style="background-color: antiquewhite"
    routerLink="/main/add"
    mat-fab>
    <mat-icon>add</mat-icon>
</button>
